{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport React, { useRef, useEffect, useState, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport canUseDOM from 'dom-lib/canUseDOM';\nimport contains from 'dom-lib/contains';\nimport getContainer from 'dom-lib/getContainer';\nimport on from 'dom-lib/on';\nimport ModalManager from './ModalManager';\nimport Fade from '../Animation/Fade';\nimport { animationPropTypes } from '../Animation/utils';\nimport { mergeRefs, usePortal, createChainedFunction, useWillUnmount, KEY_VALUES } from '../utils';\nvar manager;\n\nfunction getManager() {\n  if (!manager) manager = new ModalManager();\n  return manager;\n}\n\nvar useModalManager = function useModalManager() {\n  var modalManager = getManager();\n  var modal = useRef({\n    dialog: null,\n    backdrop: null\n  });\n  return {\n    get dialog() {\n      var _modal$current;\n\n      return (_modal$current = modal.current) === null || _modal$current === void 0 ? void 0 : _modal$current.dialog;\n    },\n\n    add: function add(containerElement, containerClassName) {\n      return modalManager.add(modal.current, containerElement, containerClassName);\n    },\n    remove: function remove() {\n      return modalManager.remove(modal.current);\n    },\n    isTopModal: function isTopModal() {\n      return modalManager.isTopModal(modal.current);\n    },\n    setDialogRef: useCallback(function (ref) {\n      modal.current.dialog = ref;\n    }, []),\n    setBackdropRef: useCallback(function (ref) {\n      modal.current.backdrop = ref;\n    }, [])\n  };\n};\n\nvar Modal = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var _props$as = props.as,\n      Component = _props$as === void 0 ? 'div' : _props$as,\n      children = props.children,\n      Transition = props.transition,\n      dialogTransitionTimeout = props.dialogTransitionTimeout,\n      style = props.style,\n      className = props.className,\n      container = props.container,\n      animationProps = props.animationProps,\n      containerClassName = props.containerClassName,\n      _props$keyboard = props.keyboard,\n      keyboard = _props$keyboard === void 0 ? true : _props$keyboard,\n      _props$enforceFocus = props.enforceFocus,\n      enforceFocus = _props$enforceFocus === void 0 ? true : _props$enforceFocus,\n      _props$backdrop = props.backdrop,\n      backdrop = _props$backdrop === void 0 ? true : _props$backdrop,\n      backdropTransitionTimeout = props.backdropTransitionTimeout,\n      backdropStyle = props.backdropStyle,\n      backdropClassName = props.backdropClassName,\n      open = props.open,\n      _props$autoFocus = props.autoFocus,\n      autoFocus = _props$autoFocus === void 0 ? true : _props$autoFocus,\n      onBackdropClick = props.onBackdropClick,\n      onEsc = props.onEsc,\n      onExit = props.onExit,\n      onExiting = props.onExiting,\n      onExited = props.onExited,\n      onEnter = props.onEnter,\n      onEntering = props.onEntering,\n      onEntered = props.onEntered,\n      onClose = props.onClose,\n      onOpen = props.onOpen,\n      rest = _objectWithoutPropertiesLoose(props, [\"as\", \"children\", \"transition\", \"dialogTransitionTimeout\", \"style\", \"className\", \"container\", \"animationProps\", \"containerClassName\", \"keyboard\", \"enforceFocus\", \"backdrop\", \"backdropTransitionTimeout\", \"backdropStyle\", \"backdropClassName\", \"open\", \"autoFocus\", \"onBackdropClick\", \"onEsc\", \"onExit\", \"onExiting\", \"onExited\", \"onEnter\", \"onEntering\", \"onEntered\", \"onClose\", \"onOpen\"]);\n\n  var _useState = useState(!open),\n      exited = _useState[0],\n      setExited = _useState[1];\n\n  var _usePortal = usePortal({\n    container: container\n  }),\n      Portal = _usePortal.Portal;\n\n  var modal = useModalManager();\n\n  if (open) {\n    if (exited) setExited(false);\n  } else if (!Transition && !exited) {\n    setExited(true);\n  }\n\n  var mountModal = open || Transition && !exited;\n  var lastFocus = useRef(null);\n  var handleDocumentKeyDown = useCallback(function (event) {\n    if (keyboard && event.key === KEY_VALUES.ESC && modal.isTopModal()) {\n      onEsc === null || onEsc === void 0 ? void 0 : onEsc(event);\n      onClose === null || onClose === void 0 ? void 0 : onClose(event);\n    }\n  }, [keyboard, modal, onEsc, onClose]);\n  var restoreLastFocus = useCallback(function () {\n    if (lastFocus.current) {\n      var _lastFocus$current$fo, _lastFocus$current;\n\n      (_lastFocus$current$fo = (_lastFocus$current = lastFocus.current).focus) === null || _lastFocus$current$fo === void 0 ? void 0 : _lastFocus$current$fo.call(_lastFocus$current);\n      lastFocus.current = null;\n    }\n  }, []);\n  var handleEnforceFocus = useCallback(function () {\n    if (!enforceFocus || !modal.isTopModal()) {\n      return;\n    }\n\n    var currentActiveElement = document.activeElement;\n    var dialog = modal.dialog;\n\n    if (dialog && dialog !== currentActiveElement && !contains(dialog, currentActiveElement)) {\n      dialog.focus();\n    }\n  }, [enforceFocus, modal]);\n  var handleBackdropClick = useCallback(function (event) {\n    if (event.target !== event.currentTarget) {\n      return;\n    }\n\n    onBackdropClick === null || onBackdropClick === void 0 ? void 0 : onBackdropClick(event);\n\n    if (backdrop === true) {\n      onClose === null || onClose === void 0 ? void 0 : onClose(event);\n    }\n  }, [backdrop, onBackdropClick, onClose]);\n  var documentKeyDownListener = useRef();\n  var documentFocusListener = useRef();\n  var handleOpen = useCallback(function () {\n    var containerElement = getContainer(container, document.body);\n    modal.add(containerElement, containerClassName);\n\n    if (!documentKeyDownListener.current) {\n      documentKeyDownListener.current = on(document, 'keydown', handleDocumentKeyDown);\n    }\n\n    if (!documentFocusListener.current) {\n      documentFocusListener.current = on(document, 'focus', handleEnforceFocus, true);\n    }\n\n    if (canUseDOM) {\n      lastFocus.current = document.activeElement;\n    }\n\n    if (autoFocus) {\n      var _modal$dialog;\n\n      (_modal$dialog = modal.dialog) === null || _modal$dialog === void 0 ? void 0 : _modal$dialog.focus();\n    }\n\n    onOpen === null || onOpen === void 0 ? void 0 : onOpen();\n  }, [autoFocus, container, containerClassName, handleDocumentKeyDown, handleEnforceFocus, modal, onOpen]);\n  var handleClose = useCallback(function () {\n    var _documentKeyDownListe, _documentFocusListene;\n\n    modal.remove();\n    (_documentKeyDownListe = documentKeyDownListener.current) === null || _documentKeyDownListe === void 0 ? void 0 : _documentKeyDownListe.off();\n    documentKeyDownListener.current = null;\n    (_documentFocusListene = documentFocusListener.current) === null || _documentFocusListene === void 0 ? void 0 : _documentFocusListene.off();\n    documentFocusListener.current = null;\n    restoreLastFocus();\n  }, [modal, restoreLastFocus]);\n  useEffect(function () {\n    if (!open) {\n      return;\n    }\n\n    handleOpen();\n  }, [open, handleOpen]);\n  useEffect(function () {\n    if (!exited) {\n      return;\n    }\n\n    handleClose();\n  }, [exited, handleClose]);\n  useWillUnmount(function () {\n    handleClose();\n  });\n  var handleExited = useCallback(function () {\n    setExited(true);\n  }, []);\n\n  if (!mountModal) {\n    return null;\n  }\n\n  var renderBackdrop = function renderBackdrop() {\n    var backdropPorps = {\n      style: backdropStyle,\n      onClick: handleBackdropClick\n    };\n\n    if (Transition) {\n      return /*#__PURE__*/React.createElement(Fade, {\n        transitionAppear: true,\n        in: open,\n        timeout: backdropTransitionTimeout\n      }, function (fadeProps, ref) {\n        var className = fadeProps.className,\n            rest = _objectWithoutPropertiesLoose(fadeProps, [\"className\"]);\n\n        return /*#__PURE__*/React.createElement(\"div\", _extends({\n          \"aria-hidden\": true\n        }, rest, backdropPorps, {\n          ref: mergeRefs(modal.setBackdropRef, ref),\n          className: classNames(backdropClassName, className)\n        }));\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", _extends({\n      \"aria-hidden\": true\n    }, backdropPorps, {\n      className: backdropClassName\n    }));\n  };\n\n  var dialogElement = Transition ? /*#__PURE__*/React.createElement(Transition, _extends({}, animationProps, {\n    transitionAppear: true,\n    unmountOnExit: true,\n    in: open,\n    timeout: dialogTransitionTimeout,\n    onExit: onExit,\n    onExiting: onExiting,\n    onExited: createChainedFunction(handleExited, onExited),\n    onEnter: onEnter,\n    onEntering: onEntering,\n    onEntered: onEntered\n  }), children) : children;\n  return /*#__PURE__*/React.createElement(Portal, null, /*#__PURE__*/React.createElement(Component, _extends({}, rest, {\n    ref: mergeRefs(modal.setDialogRef, ref),\n    style: style,\n    className: className,\n    tabIndex: -1\n  }), backdrop && renderBackdrop(), dialogElement));\n});\nexport var modalPropTypes = {\n  as: PropTypes.elementType,\n  className: PropTypes.string,\n  backdropClassName: PropTypes.string,\n  style: PropTypes.object,\n  backdropStyle: PropTypes.object,\n  open: PropTypes.bool,\n  backdrop: PropTypes.oneOfType([PropTypes.bool, PropTypes.string]),\n  keyboard: PropTypes.bool,\n  autoFocus: PropTypes.bool,\n  enforceFocus: PropTypes.bool,\n  animationProps: PropTypes.object,\n  onOpen: PropTypes.func,\n  onClose: PropTypes.func\n};\nModal.displayName = 'OverlayModal';\nModal.propTypes = _extends({}, animationPropTypes, modalPropTypes, {\n  children: PropTypes.func,\n  container: PropTypes.any,\n  containerClassName: PropTypes.string,\n  dialogTransitionTimeout: PropTypes.number,\n  backdropTransitionTimeout: PropTypes.number,\n  transition: PropTypes.any,\n  onEsc: PropTypes.func,\n  onBackdropClick: PropTypes.func\n});\nexport default Modal;","map":{"version":3,"sources":["/Users/pango/Documents/Open/opener/frontend/node_modules/rsuite/esm/Overlay/Modal.js"],"names":["_extends","_objectWithoutPropertiesLoose","React","useRef","useEffect","useState","useCallback","PropTypes","classNames","canUseDOM","contains","getContainer","on","ModalManager","Fade","animationPropTypes","mergeRefs","usePortal","createChainedFunction","useWillUnmount","KEY_VALUES","manager","getManager","useModalManager","modalManager","modal","dialog","backdrop","_modal$current","current","add","containerElement","containerClassName","remove","isTopModal","setDialogRef","ref","setBackdropRef","Modal","forwardRef","props","_props$as","as","Component","children","Transition","transition","dialogTransitionTimeout","style","className","container","animationProps","_props$keyboard","keyboard","_props$enforceFocus","enforceFocus","_props$backdrop","backdropTransitionTimeout","backdropStyle","backdropClassName","open","_props$autoFocus","autoFocus","onBackdropClick","onEsc","onExit","onExiting","onExited","onEnter","onEntering","onEntered","onClose","onOpen","rest","_useState","exited","setExited","_usePortal","Portal","mountModal","lastFocus","handleDocumentKeyDown","event","key","ESC","restoreLastFocus","_lastFocus$current$fo","_lastFocus$current","focus","call","handleEnforceFocus","currentActiveElement","document","activeElement","handleBackdropClick","target","currentTarget","documentKeyDownListener","documentFocusListener","handleOpen","body","_modal$dialog","handleClose","_documentKeyDownListe","_documentFocusListene","off","handleExited","renderBackdrop","backdropPorps","onClick","createElement","transitionAppear","in","timeout","fadeProps","dialogElement","unmountOnExit","tabIndex","modalPropTypes","elementType","string","object","bool","oneOfType","func","displayName","propTypes","any","number"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport React, { useRef, useEffect, useState, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport canUseDOM from 'dom-lib/canUseDOM';\nimport contains from 'dom-lib/contains';\nimport getContainer from 'dom-lib/getContainer';\nimport on from 'dom-lib/on';\nimport ModalManager from './ModalManager';\nimport Fade from '../Animation/Fade';\nimport { animationPropTypes } from '../Animation/utils';\nimport { mergeRefs, usePortal, createChainedFunction, useWillUnmount, KEY_VALUES } from '../utils';\nvar manager;\n\nfunction getManager() {\n  if (!manager) manager = new ModalManager();\n  return manager;\n}\n\nvar useModalManager = function useModalManager() {\n  var modalManager = getManager();\n  var modal = useRef({\n    dialog: null,\n    backdrop: null\n  });\n  return {\n    get dialog() {\n      var _modal$current;\n\n      return (_modal$current = modal.current) === null || _modal$current === void 0 ? void 0 : _modal$current.dialog;\n    },\n\n    add: function add(containerElement, containerClassName) {\n      return modalManager.add(modal.current, containerElement, containerClassName);\n    },\n    remove: function remove() {\n      return modalManager.remove(modal.current);\n    },\n    isTopModal: function isTopModal() {\n      return modalManager.isTopModal(modal.current);\n    },\n    setDialogRef: useCallback(function (ref) {\n      modal.current.dialog = ref;\n    }, []),\n    setBackdropRef: useCallback(function (ref) {\n      modal.current.backdrop = ref;\n    }, [])\n  };\n};\n\nvar Modal = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var _props$as = props.as,\n      Component = _props$as === void 0 ? 'div' : _props$as,\n      children = props.children,\n      Transition = props.transition,\n      dialogTransitionTimeout = props.dialogTransitionTimeout,\n      style = props.style,\n      className = props.className,\n      container = props.container,\n      animationProps = props.animationProps,\n      containerClassName = props.containerClassName,\n      _props$keyboard = props.keyboard,\n      keyboard = _props$keyboard === void 0 ? true : _props$keyboard,\n      _props$enforceFocus = props.enforceFocus,\n      enforceFocus = _props$enforceFocus === void 0 ? true : _props$enforceFocus,\n      _props$backdrop = props.backdrop,\n      backdrop = _props$backdrop === void 0 ? true : _props$backdrop,\n      backdropTransitionTimeout = props.backdropTransitionTimeout,\n      backdropStyle = props.backdropStyle,\n      backdropClassName = props.backdropClassName,\n      open = props.open,\n      _props$autoFocus = props.autoFocus,\n      autoFocus = _props$autoFocus === void 0 ? true : _props$autoFocus,\n      onBackdropClick = props.onBackdropClick,\n      onEsc = props.onEsc,\n      onExit = props.onExit,\n      onExiting = props.onExiting,\n      onExited = props.onExited,\n      onEnter = props.onEnter,\n      onEntering = props.onEntering,\n      onEntered = props.onEntered,\n      onClose = props.onClose,\n      onOpen = props.onOpen,\n      rest = _objectWithoutPropertiesLoose(props, [\"as\", \"children\", \"transition\", \"dialogTransitionTimeout\", \"style\", \"className\", \"container\", \"animationProps\", \"containerClassName\", \"keyboard\", \"enforceFocus\", \"backdrop\", \"backdropTransitionTimeout\", \"backdropStyle\", \"backdropClassName\", \"open\", \"autoFocus\", \"onBackdropClick\", \"onEsc\", \"onExit\", \"onExiting\", \"onExited\", \"onEnter\", \"onEntering\", \"onEntered\", \"onClose\", \"onOpen\"]);\n\n  var _useState = useState(!open),\n      exited = _useState[0],\n      setExited = _useState[1];\n\n  var _usePortal = usePortal({\n    container: container\n  }),\n      Portal = _usePortal.Portal;\n\n  var modal = useModalManager();\n\n  if (open) {\n    if (exited) setExited(false);\n  } else if (!Transition && !exited) {\n    setExited(true);\n  }\n\n  var mountModal = open || Transition && !exited;\n  var lastFocus = useRef(null);\n  var handleDocumentKeyDown = useCallback(function (event) {\n    if (keyboard && event.key === KEY_VALUES.ESC && modal.isTopModal()) {\n      onEsc === null || onEsc === void 0 ? void 0 : onEsc(event);\n      onClose === null || onClose === void 0 ? void 0 : onClose(event);\n    }\n  }, [keyboard, modal, onEsc, onClose]);\n  var restoreLastFocus = useCallback(function () {\n    if (lastFocus.current) {\n      var _lastFocus$current$fo, _lastFocus$current;\n\n      (_lastFocus$current$fo = (_lastFocus$current = lastFocus.current).focus) === null || _lastFocus$current$fo === void 0 ? void 0 : _lastFocus$current$fo.call(_lastFocus$current);\n      lastFocus.current = null;\n    }\n  }, []);\n  var handleEnforceFocus = useCallback(function () {\n    if (!enforceFocus || !modal.isTopModal()) {\n      return;\n    }\n\n    var currentActiveElement = document.activeElement;\n    var dialog = modal.dialog;\n\n    if (dialog && dialog !== currentActiveElement && !contains(dialog, currentActiveElement)) {\n      dialog.focus();\n    }\n  }, [enforceFocus, modal]);\n  var handleBackdropClick = useCallback(function (event) {\n    if (event.target !== event.currentTarget) {\n      return;\n    }\n\n    onBackdropClick === null || onBackdropClick === void 0 ? void 0 : onBackdropClick(event);\n\n    if (backdrop === true) {\n      onClose === null || onClose === void 0 ? void 0 : onClose(event);\n    }\n  }, [backdrop, onBackdropClick, onClose]);\n  var documentKeyDownListener = useRef();\n  var documentFocusListener = useRef();\n  var handleOpen = useCallback(function () {\n    var containerElement = getContainer(container, document.body);\n    modal.add(containerElement, containerClassName);\n\n    if (!documentKeyDownListener.current) {\n      documentKeyDownListener.current = on(document, 'keydown', handleDocumentKeyDown);\n    }\n\n    if (!documentFocusListener.current) {\n      documentFocusListener.current = on(document, 'focus', handleEnforceFocus, true);\n    }\n\n    if (canUseDOM) {\n      lastFocus.current = document.activeElement;\n    }\n\n    if (autoFocus) {\n      var _modal$dialog;\n\n      (_modal$dialog = modal.dialog) === null || _modal$dialog === void 0 ? void 0 : _modal$dialog.focus();\n    }\n\n    onOpen === null || onOpen === void 0 ? void 0 : onOpen();\n  }, [autoFocus, container, containerClassName, handleDocumentKeyDown, handleEnforceFocus, modal, onOpen]);\n  var handleClose = useCallback(function () {\n    var _documentKeyDownListe, _documentFocusListene;\n\n    modal.remove();\n    (_documentKeyDownListe = documentKeyDownListener.current) === null || _documentKeyDownListe === void 0 ? void 0 : _documentKeyDownListe.off();\n    documentKeyDownListener.current = null;\n    (_documentFocusListene = documentFocusListener.current) === null || _documentFocusListene === void 0 ? void 0 : _documentFocusListene.off();\n    documentFocusListener.current = null;\n    restoreLastFocus();\n  }, [modal, restoreLastFocus]);\n  useEffect(function () {\n    if (!open) {\n      return;\n    }\n\n    handleOpen();\n  }, [open, handleOpen]);\n  useEffect(function () {\n    if (!exited) {\n      return;\n    }\n\n    handleClose();\n  }, [exited, handleClose]);\n  useWillUnmount(function () {\n    handleClose();\n  });\n  var handleExited = useCallback(function () {\n    setExited(true);\n  }, []);\n\n  if (!mountModal) {\n    return null;\n  }\n\n  var renderBackdrop = function renderBackdrop() {\n    var backdropPorps = {\n      style: backdropStyle,\n      onClick: handleBackdropClick\n    };\n\n    if (Transition) {\n      return /*#__PURE__*/React.createElement(Fade, {\n        transitionAppear: true,\n        in: open,\n        timeout: backdropTransitionTimeout\n      }, function (fadeProps, ref) {\n        var className = fadeProps.className,\n            rest = _objectWithoutPropertiesLoose(fadeProps, [\"className\"]);\n\n        return /*#__PURE__*/React.createElement(\"div\", _extends({\n          \"aria-hidden\": true\n        }, rest, backdropPorps, {\n          ref: mergeRefs(modal.setBackdropRef, ref),\n          className: classNames(backdropClassName, className)\n        }));\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", _extends({\n      \"aria-hidden\": true\n    }, backdropPorps, {\n      className: backdropClassName\n    }));\n  };\n\n  var dialogElement = Transition ? /*#__PURE__*/React.createElement(Transition, _extends({}, animationProps, {\n    transitionAppear: true,\n    unmountOnExit: true,\n    in: open,\n    timeout: dialogTransitionTimeout,\n    onExit: onExit,\n    onExiting: onExiting,\n    onExited: createChainedFunction(handleExited, onExited),\n    onEnter: onEnter,\n    onEntering: onEntering,\n    onEntered: onEntered\n  }), children) : children;\n  return /*#__PURE__*/React.createElement(Portal, null, /*#__PURE__*/React.createElement(Component, _extends({}, rest, {\n    ref: mergeRefs(modal.setDialogRef, ref),\n    style: style,\n    className: className,\n    tabIndex: -1\n  }), backdrop && renderBackdrop(), dialogElement));\n});\nexport var modalPropTypes = {\n  as: PropTypes.elementType,\n  className: PropTypes.string,\n  backdropClassName: PropTypes.string,\n  style: PropTypes.object,\n  backdropStyle: PropTypes.object,\n  open: PropTypes.bool,\n  backdrop: PropTypes.oneOfType([PropTypes.bool, PropTypes.string]),\n  keyboard: PropTypes.bool,\n  autoFocus: PropTypes.bool,\n  enforceFocus: PropTypes.bool,\n  animationProps: PropTypes.object,\n  onOpen: PropTypes.func,\n  onClose: PropTypes.func\n};\nModal.displayName = 'OverlayModal';\nModal.propTypes = _extends({}, animationPropTypes, modalPropTypes, {\n  children: PropTypes.func,\n  container: PropTypes.any,\n  containerClassName: PropTypes.string,\n  dialogTransitionTimeout: PropTypes.number,\n  backdropTransitionTimeout: PropTypes.number,\n  transition: PropTypes.any,\n  onEsc: PropTypes.func,\n  onBackdropClick: PropTypes.func\n});\nexport default Modal;"]},"metadata":{},"sourceType":"module"}