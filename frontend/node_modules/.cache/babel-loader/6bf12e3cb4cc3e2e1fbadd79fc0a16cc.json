{"ast":null,"code":"import { useRef, useCallback, useEffect } from 'react';\nimport getHeight from 'dom-lib/getHeight';\nimport addStyle from 'dom-lib/addStyle';\nimport removeStyle from 'dom-lib/removeStyle';\nimport on from 'dom-lib/on';\nimport toggleClass from './toggleClass';\nimport isNumberOrTrue from './isNumberOrTrue';\nimport useUpdateEffect from './useUpdateEffect';\n\nvar useAffix = function useAffix(props) {\n  var tableHeight = props.tableHeight,\n      contentHeight = props.contentHeight,\n      affixHorizontalScrollbar = props.affixHorizontalScrollbar,\n      affixHeader = props.affixHeader,\n      tableOffset = props.tableOffset,\n      headerOffset = props.headerOffset,\n      headerHeight = props.headerHeight,\n      scrollbarXRef = props.scrollbarXRef,\n      affixHeaderWrapperRef = props.affixHeaderWrapperRef;\n  var scrollListener = useRef();\n  var handleAffixHorizontalScrollbar = useCallback(function () {\n    var _scrollbarXRef$curren;\n\n    var scrollY = window.scrollY || window.pageYOffset;\n    var windowHeight = getHeight(window);\n    var height = tableHeight();\n    var bottom = typeof affixHorizontalScrollbar === 'number' ? affixHorizontalScrollbar : 0;\n    var fixedScrollbar = scrollY + windowHeight < height + (tableOffset.current.top + bottom) && scrollY + windowHeight - headerHeight > tableOffset.current.top + bottom;\n\n    if (scrollbarXRef !== null && scrollbarXRef !== void 0 && (_scrollbarXRef$curren = scrollbarXRef.current) !== null && _scrollbarXRef$curren !== void 0 && _scrollbarXRef$curren.root) {\n      toggleClass(scrollbarXRef.current.root, 'fixed', fixedScrollbar);\n\n      if (fixedScrollbar) {\n        addStyle(scrollbarXRef.current.root, 'bottom', bottom + \"px\");\n      } else {\n        removeStyle(scrollbarXRef.current.root, 'bottom');\n      }\n    }\n  }, [affixHorizontalScrollbar, headerHeight, scrollbarXRef, tableHeight, tableOffset]);\n  var handleAffixTableHeader = useCallback(function () {\n    var top = typeof affixHeader === 'number' ? affixHeader : 0;\n    var scrollY = window.scrollY || window.pageYOffset;\n    var fixedHeader = scrollY - (headerOffset.current.top - top) >= 0 && scrollY < headerOffset.current.top - top + contentHeight.current;\n\n    if (affixHeaderWrapperRef.current) {\n      toggleClass(affixHeaderWrapperRef.current, 'fixed', fixedHeader);\n    }\n  }, [affixHeader, affixHeaderWrapperRef, contentHeight, headerOffset]);\n  var handleWindowScroll = useCallback(function () {\n    if (isNumberOrTrue(affixHeader)) {\n      handleAffixTableHeader();\n    }\n\n    if (isNumberOrTrue(affixHorizontalScrollbar)) {\n      handleAffixHorizontalScrollbar();\n    }\n  }, [affixHeader, affixHorizontalScrollbar, handleAffixTableHeader, handleAffixHorizontalScrollbar]);\n  /**\n   * Update the position of the fixed element after the height of the table changes.\n   * fix: https://github.com/rsuite/rsuite/issues/1716\n   */\n\n  useUpdateEffect(handleWindowScroll, [tableHeight]);\n  useEffect(function () {\n    if (isNumberOrTrue(affixHeader) || isNumberOrTrue(affixHorizontalScrollbar)) {\n      scrollListener.current = on(window, 'scroll', handleWindowScroll);\n    }\n\n    return function () {\n      var _scrollListener$curre;\n\n      (_scrollListener$curre = scrollListener.current) === null || _scrollListener$curre === void 0 ? void 0 : _scrollListener$curre.off();\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n};\n\nexport default useAffix;","map":{"version":3,"sources":["/Users/pango/Documents/Open/opener/frontend/node_modules/rsuite-table/es/utils/useAffix.js"],"names":["useRef","useCallback","useEffect","getHeight","addStyle","removeStyle","on","toggleClass","isNumberOrTrue","useUpdateEffect","useAffix","props","tableHeight","contentHeight","affixHorizontalScrollbar","affixHeader","tableOffset","headerOffset","headerHeight","scrollbarXRef","affixHeaderWrapperRef","scrollListener","handleAffixHorizontalScrollbar","_scrollbarXRef$curren","scrollY","window","pageYOffset","windowHeight","height","bottom","fixedScrollbar","current","top","root","handleAffixTableHeader","fixedHeader","handleWindowScroll","_scrollListener$curre","off"],"mappings":"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","sourcesContent":["import { useRef, useCallback, useEffect } from 'react';\nimport getHeight from 'dom-lib/getHeight';\nimport addStyle from 'dom-lib/addStyle';\nimport removeStyle from 'dom-lib/removeStyle';\nimport on from 'dom-lib/on';\nimport toggleClass from './toggleClass';\nimport isNumberOrTrue from './isNumberOrTrue';\nimport useUpdateEffect from './useUpdateEffect';\n\nvar useAffix = function useAffix(props) {\n  var tableHeight = props.tableHeight,\n      contentHeight = props.contentHeight,\n      affixHorizontalScrollbar = props.affixHorizontalScrollbar,\n      affixHeader = props.affixHeader,\n      tableOffset = props.tableOffset,\n      headerOffset = props.headerOffset,\n      headerHeight = props.headerHeight,\n      scrollbarXRef = props.scrollbarXRef,\n      affixHeaderWrapperRef = props.affixHeaderWrapperRef;\n  var scrollListener = useRef();\n  var handleAffixHorizontalScrollbar = useCallback(function () {\n    var _scrollbarXRef$curren;\n\n    var scrollY = window.scrollY || window.pageYOffset;\n    var windowHeight = getHeight(window);\n    var height = tableHeight();\n    var bottom = typeof affixHorizontalScrollbar === 'number' ? affixHorizontalScrollbar : 0;\n    var fixedScrollbar = scrollY + windowHeight < height + (tableOffset.current.top + bottom) && scrollY + windowHeight - headerHeight > tableOffset.current.top + bottom;\n\n    if (scrollbarXRef !== null && scrollbarXRef !== void 0 && (_scrollbarXRef$curren = scrollbarXRef.current) !== null && _scrollbarXRef$curren !== void 0 && _scrollbarXRef$curren.root) {\n      toggleClass(scrollbarXRef.current.root, 'fixed', fixedScrollbar);\n\n      if (fixedScrollbar) {\n        addStyle(scrollbarXRef.current.root, 'bottom', bottom + \"px\");\n      } else {\n        removeStyle(scrollbarXRef.current.root, 'bottom');\n      }\n    }\n  }, [affixHorizontalScrollbar, headerHeight, scrollbarXRef, tableHeight, tableOffset]);\n  var handleAffixTableHeader = useCallback(function () {\n    var top = typeof affixHeader === 'number' ? affixHeader : 0;\n    var scrollY = window.scrollY || window.pageYOffset;\n    var fixedHeader = scrollY - (headerOffset.current.top - top) >= 0 && scrollY < headerOffset.current.top - top + contentHeight.current;\n\n    if (affixHeaderWrapperRef.current) {\n      toggleClass(affixHeaderWrapperRef.current, 'fixed', fixedHeader);\n    }\n  }, [affixHeader, affixHeaderWrapperRef, contentHeight, headerOffset]);\n  var handleWindowScroll = useCallback(function () {\n    if (isNumberOrTrue(affixHeader)) {\n      handleAffixTableHeader();\n    }\n\n    if (isNumberOrTrue(affixHorizontalScrollbar)) {\n      handleAffixHorizontalScrollbar();\n    }\n  }, [affixHeader, affixHorizontalScrollbar, handleAffixTableHeader, handleAffixHorizontalScrollbar]);\n  /**\n   * Update the position of the fixed element after the height of the table changes.\n   * fix: https://github.com/rsuite/rsuite/issues/1716\n   */\n\n  useUpdateEffect(handleWindowScroll, [tableHeight]);\n  useEffect(function () {\n    if (isNumberOrTrue(affixHeader) || isNumberOrTrue(affixHorizontalScrollbar)) {\n      scrollListener.current = on(window, 'scroll', handleWindowScroll);\n    }\n\n    return function () {\n      var _scrollListener$curre;\n\n      (_scrollListener$curre = scrollListener.current) === null || _scrollListener$curre === void 0 ? void 0 : _scrollListener$curre.off();\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n};\n\nexport default useAffix;"]},"metadata":{},"sourceType":"module"}